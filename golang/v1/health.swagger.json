{
  "swagger": "2.0",
  "info": {
    "title": "health.proto",
    "version": "version not set"
  },
  "tags": [
    {
      "name": "MBLink"
    }
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {},
  "definitions": {
    "googlerpcStatus": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32"
        },
        "message": {
          "type": "string"
        },
        "details": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/protobufAny"
          }
        }
      }
    },
    "mbpbAcceptAction": {
      "type": "string",
      "enum": [
        "Nothing",
        "NewFlow",
        "AppendFlow",
        "MergeFlow"
      ],
      "default": "Nothing",
      "title": "- Nothing: 无任何动作\n - NewFlow: 新建工作流\n - AppendFlow: 追加工作流\n - MergeFlow: 合并工作流"
    },
    "mbpbAck": {
      "type": "object",
      "properties": {
        "key": {
          "type": "string"
        },
        "sequenceID": {
          "type": "string"
        },
        "error": {
          "$ref": "#/definitions/mbpbError"
        },
        "now": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "mbpbColumn": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "primary_key": {
          "type": "boolean"
        },
        "not_null": {
          "type": "boolean"
        },
        "unique": {
          "type": "boolean"
        },
        "type_modifier": {
          "type": "integer",
          "format": "int32"
        }
      },
      "title": "字段类"
    },
    "mbpbCrontab": {
      "type": "object",
      "properties": {
        "enable": {
          "type": "boolean",
          "title": "调度状态"
        },
        "lifeCycle": {
          "$ref": "#/definitions/mbpbLifeCycle",
          "title": "生命周期"
        },
        "cycleOnce": {
          "$ref": "#/definitions/mbpbCycleOnce",
          "title": "只执行1次"
        },
        "cycleEvery": {
          "$ref": "#/definitions/mbpbCycleEvery",
          "title": "每隔多久执行一次"
        },
        "cycleEveryTime": {
          "$ref": "#/definitions/mbpbCycleEveryTime",
          "title": "时间循环周期执行"
        }
      },
      "title": "Crontab表达式"
    },
    "mbpbCycleEvery": {
      "type": "object",
      "properties": {
        "everyExpress": {
          "$ref": "#/definitions/mbpbEveryExpress",
          "title": "间隔周期"
        },
        "expression": {
          "$ref": "#/definitions/mbpbExpression",
          "title": "表达式 Expression己弃用,应使用EveryExpress"
        }
      },
      "title": "间隔时间执行"
    },
    "mbpbCycleEveryDay": {
      "type": "object",
      "title": "每天"
    },
    "mbpbCycleEveryMonth": {
      "type": "object",
      "properties": {
        "day": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "int32"
          },
          "title": "天 切片"
        }
      },
      "title": "每月"
    },
    "mbpbCycleEveryQuarter": {
      "type": "object",
      "properties": {
        "month": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbWithQuarter"
          },
          "title": "季切片"
        }
      },
      "title": "每季度"
    },
    "mbpbCycleEveryTime": {
      "type": "object",
      "properties": {
        "everyType": {
          "$ref": "#/definitions/mbpbEveryTimeType",
          "title": "类型"
        },
        "runTime": {
          "$ref": "#/definitions/mbpbCycleHour",
          "title": "运行时间"
        },
        "everyDay": {
          "$ref": "#/definitions/mbpbCycleEveryDay",
          "title": "每天"
        },
        "everyWeek": {
          "$ref": "#/definitions/mbpbCycleEveryWeek",
          "title": "每周"
        },
        "everyMonth": {
          "$ref": "#/definitions/mbpbCycleEveryMonth",
          "title": "每月"
        },
        "everyQuarter": {
          "$ref": "#/definitions/mbpbCycleEveryQuarter",
          "title": "每季"
        },
        "everyYear": {
          "$ref": "#/definitions/mbpbCycleEveryYear",
          "title": "每年"
        }
      },
      "title": "时间循环周期执行"
    },
    "mbpbCycleEveryWeek": {
      "type": "object",
      "properties": {
        "week": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/mbpbEnumWeek"
          },
          "title": "周 切片"
        }
      },
      "title": "每周"
    },
    "mbpbCycleEveryYear": {
      "type": "object",
      "properties": {
        "month": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbWithMonth"
          },
          "title": "月 切片"
        }
      },
      "title": "按年 包含12个月 每个月不同的天"
    },
    "mbpbCycleHour": {
      "type": "object",
      "properties": {
        "hour": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "int32"
          },
          "title": "小时 切片"
        },
        "minute": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "int32"
          },
          "title": "分钟 切片"
        }
      },
      "title": "小时"
    },
    "mbpbCycleOnce": {
      "type": "object",
      "properties": {
        "expression": {
          "$ref": "#/definitions/mbpbExpression",
          "title": "表达式 Expression应置空"
        }
      },
      "title": "执行一次"
    },
    "mbpbDBDetail": {
      "type": "object",
      "properties": {
        "db_type": {
          "$ref": "#/definitions/mbpbDBType",
          "title": "engine 引擎"
        },
        "postgres": {
          "$ref": "#/definitions/mbpbGenericDB"
        },
        "doris": {
          "$ref": "#/definitions/mbpbDoris"
        },
        "mysql": {
          "$ref": "#/definitions/mbpbGenericDB"
        }
      },
      "title": "数据库信息"
    },
    "mbpbDBType": {
      "type": "string",
      "enum": [
        "UNSPECIFIED",
        "POSTGRES",
        "DORIS",
        "MYSQL"
      ],
      "default": "UNSPECIFIED",
      "title": "- UNSPECIFIED: 未定义\n - POSTGRES: postgres\n - DORIS: doris\n - MYSQL: mysql"
    },
    "mbpbDetail": {
      "type": "object",
      "properties": {
        "rowsCount": {
          "type": "string",
          "format": "int64",
          "title": "行数"
        },
        "columns": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbColumn"
          },
          "title": "字段类"
        },
        "outTable": {
          "$ref": "#/definitions/mbpbTable",
          "title": "实体表"
        },
        "startTime": {
          "type": "string",
          "title": "开始运行时间 精确到纳秒"
        },
        "endTime": {
          "type": "string",
          "title": "结束运行时间 精确到纳秒"
        },
        "sequenceId": {
          "type": "string",
          "title": "节点sequenceId"
        }
      },
      "title": "详情"
    },
    "mbpbDoris": {
      "type": "object",
      "properties": {
        "host": {
          "type": "string",
          "title": "数据主机地址"
        },
        "http_port": {
          "type": "integer",
          "format": "int32",
          "title": "http协议端口 例如: 8030"
        },
        "query_port": {
          "type": "integer",
          "format": "int32",
          "title": "sql协议端口 例如: 9030"
        },
        "flight_port": {
          "type": "integer",
          "format": "int32",
          "title": "Flight SQL端口 例如: 9090"
        },
        "user": {
          "type": "string",
          "title": "数据库用户名"
        },
        "pwd": {
          "type": "string",
          "title": "数据库密码"
        },
        "db_name": {
          "type": "string",
          "title": "数据库名称"
        },
        "connect_params": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "连接参数"
        }
      }
    },
    "mbpbEdge": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "title": "唯一键"
        },
        "source": {
          "type": "string",
          "title": "上游"
        },
        "target": {
          "type": "string",
          "title": "下游"
        }
      },
      "title": "边缘"
    },
    "mbpbEnableReply": {
      "type": "object",
      "properties": {
        "outTable": {
          "$ref": "#/definitions/mbpbTable",
          "title": "结果表"
        },
        "columns": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbColumn"
          },
          "title": "字段类"
        },
        "nextRunTime": {
          "type": "string",
          "title": "下次运行时间"
        },
        "error": {
          "$ref": "#/definitions/mbpbError",
          "title": "错误信息 可选"
        },
        "flowData": {
          "$ref": "#/definitions/mbpbFlowMetadata",
          "title": "工作流元数据"
        }
      },
      "title": "启用回复"
    },
    "mbpbEnableRequest": {
      "type": "object",
      "properties": {
        "source_db": {
          "$ref": "#/definitions/mbpbDBDetail",
          "title": "源数据库"
        },
        "target_db": {
          "$ref": "#/definitions/mbpbDBDetail",
          "title": "目标数据库"
        },
        "enterprise_id": {
          "type": "string",
          "title": "企业ID"
        },
        "card_id": {
          "type": "string",
          "format": "int64",
          "title": "Card ID"
        },
        "user_id": {
          "type": "string",
          "format": "int64",
          "title": "创建人"
        },
        "crontab": {
          "$ref": "#/definitions/mbpbCrontab",
          "title": "运行周期表达式"
        },
        "sql_script": {
          "type": "string",
          "title": "SQL代码"
        },
        "tables": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbTable"
          },
          "title": "SQL引用的实体表"
        },
        "extra": {
          "$ref": "#/definitions/mbpbExtra",
          "title": "附加信息"
        },
        "over": {
          "$ref": "#/definitions/mbpbOver",
          "title": "BI不传"
        },
        "skip_workflow": {
          "type": "boolean",
          "title": "跳过工作流"
        },
        "all_tables": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbTable"
          },
          "title": "所有实体表 BI不传"
        }
      },
      "title": "启用请求"
    },
    "mbpbEnumMonth": {
      "type": "string",
      "enum": [
        "None",
        "Jan",
        "Feb",
        "Mar",
        "Apr",
        "May",
        "Jun",
        "Jul",
        "Aug",
        "Sep",
        "Oct",
        "Nov",
        "Dec"
      ],
      "default": "None",
      "title": "月枚举"
    },
    "mbpbEnumWeek": {
      "type": "string",
      "enum": [
        "Sun",
        "Mon",
        "Tue",
        "Wed",
        "Thu",
        "Fri",
        "Sat"
      ],
      "default": "Sun",
      "description": "- Sun: 周日\n - Mon: 周一\n - Tue: 周二\n - Wed: 周三\n - Thu: 周四\n - Fri: 周五\n - Sat: 周六",
      "title": "周枚举"
    },
    "mbpbError": {
      "type": "object",
      "properties": {
        "code": {
          "type": "integer",
          "format": "int32",
          "title": "错误码"
        },
        "msg": {
          "type": "string",
          "title": "错误信息"
        }
      },
      "title": "错误信息"
    },
    "mbpbEveryExpress": {
      "type": "object",
      "properties": {
        "cycleType": {
          "$ref": "#/definitions/mbpbEveryType",
          "title": "类型"
        },
        "cycleValue": {
          "type": "integer",
          "format": "int32",
          "title": "Value"
        }
      },
      "title": "间隔周期"
    },
    "mbpbEveryTimeType": {
      "type": "string",
      "enum": [
        "EveryNone",
        "EveryDay",
        "EveryWeek",
        "EveryMonth",
        "EveryQuarter",
        "EveryYear"
      ],
      "default": "EveryNone",
      "description": "- EveryNone: 未知\n - EveryDay: 每天\n - EveryWeek: 每周\n - EveryMonth: 每月\n - EveryQuarter: 每季\n - EveryYear: 每年",
      "title": "周期类型"
    },
    "mbpbEveryType": {
      "type": "string",
      "enum": [
        "EvNone",
        "EvMinute",
        "EvHour",
        "EvDay",
        "EvWeek",
        "EvMonth"
      ],
      "default": "EvNone",
      "description": "- EvNone: 未定义\n - EvMinute: N分钟\n - EvHour: N小时\n - EvDay: N天\n - EvWeek: N周\n - EvMonth: N月",
      "title": "间隔时间执行类型"
    },
    "mbpbExpression": {
      "type": "object",
      "properties": {
        "express": {
          "type": "string",
          "title": "表达式"
        }
      },
      "title": "表达式"
    },
    "mbpbExtra": {
      "type": "object",
      "properties": {
        "grouping": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbFQN"
          },
          "title": "分组信息"
        },
        "selects": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbFQN"
          },
          "title": "最外层查询列信息"
        }
      },
      "title": "附加信息"
    },
    "mbpbFQN": {
      "type": "object",
      "properties": {
        "schema": {
          "type": "string"
        },
        "table": {
          "type": "string"
        },
        "column": {
          "type": "string"
        }
      },
      "title": "Fully Qualified Name"
    },
    "mbpbFlowMap": {
      "type": "object",
      "properties": {
        "uuid": {
          "type": "string"
        },
        "flowID": {
          "type": "string",
          "format": "int64"
        }
      }
    },
    "mbpbFlowMetadata": {
      "type": "object",
      "properties": {
        "taskType": {
          "$ref": "#/definitions/mbpbTaskType",
          "title": "任务类型"
        },
        "beforeFlow": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/mbpbGraph"
          },
          "title": "流程图 key代表现有工作流ID\n2do可能存在多个任务流,map 工作流ID"
        },
        "afterFlow": {
          "$ref": "#/definitions/mbpbGraph",
          "title": "合并后、或加入后的工作流"
        },
        "acceptAction": {
          "$ref": "#/definitions/mbpbAcceptAction",
          "title": "确认动作,点击是或否后的动作"
        },
        "flowMap": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/mbpbFlowMap"
          },
          "title": "工作流ID映射"
        },
        "flowID": {
          "type": "string",
          "format": "int64",
          "title": "任务流ID"
        }
      },
      "title": "工作流元数据"
    },
    "mbpbGenericDB": {
      "type": "object",
      "properties": {
        "host": {
          "type": "string",
          "title": "数据主机地址"
        },
        "port": {
          "type": "integer",
          "format": "int32",
          "title": "数据库端口"
        },
        "user": {
          "type": "string",
          "title": "数据库用户名"
        },
        "pwd": {
          "type": "string",
          "title": "数据库密码"
        },
        "db_name": {
          "type": "string",
          "title": "数据库名称"
        },
        "connect_params": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "title": "连接参数"
        }
      }
    },
    "mbpbGraph": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "title": "id"
        },
        "children": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbSource"
          },
          "title": "节点"
        },
        "edges": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbEdge"
          },
          "title": "边缘"
        },
        "error": {
          "$ref": "#/definitions/mbpbError",
          "title": "错误信息"
        }
      }
    },
    "mbpbHealthReply": {
      "type": "object",
      "properties": {
        "healthy": {
          "type": "boolean"
        }
      }
    },
    "mbpbLifeCycle": {
      "type": "object",
      "properties": {
        "zone": {
          "type": "string",
          "title": "时区"
        },
        "startTime": {
          "type": "string",
          "title": "执行时间"
        },
        "endTime": {
          "type": "string",
          "title": "结束时间 无限期为null"
        }
      },
      "title": "生命周期"
    },
    "mbpbNodeDetail": {
      "type": "object",
      "properties": {
        "key": {
          "type": "string"
        },
        "enterpriseID": {
          "type": "string"
        },
        "cardId": {
          "type": "string",
          "format": "int64",
          "title": "cardId"
        },
        "sequenceID": {
          "type": "string"
        },
        "detail": {
          "$ref": "#/definitions/mbpbDetail",
          "title": "card detail"
        },
        "runStatus": {
          "$ref": "#/definitions/mbpbRunStatus"
        },
        "target_db": {
          "$ref": "#/definitions/mbpbDBDetail"
        },
        "error": {
          "$ref": "#/definitions/mbpbError"
        }
      }
    },
    "mbpbOver": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "string",
          "title": "uid"
        },
        "sequenceID": {
          "type": "string",
          "title": "SequenceID"
        },
        "runType": {
          "$ref": "#/definitions/mbpbRunType",
          "title": "运行类型"
        },
        "startRunTime": {
          "type": "string",
          "format": "date-time",
          "title": "开始运行时间"
        },
        "nextRunTime": {
          "type": "string",
          "format": "date-time",
          "title": "下次运行时间"
        },
        "taskType": {
          "$ref": "#/definitions/mbpbTaskType",
          "title": "任务类型"
        },
        "flowSequenceID": {
          "type": "string",
          "title": "工作流唯一标识"
        },
        "children": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbSource"
          },
          "title": "工作流节点"
        }
      }
    },
    "mbpbProperty": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "title": "原始唯一键"
        },
        "type": {
          "$ref": "#/definitions/mbpbSourceType",
          "title": "类型"
        }
      }
    },
    "mbpbReply": {
      "type": "object",
      "properties": {
        "key": {
          "type": "string",
          "title": "Key"
        },
        "sequenceID": {
          "type": "string",
          "title": "序列ID"
        },
        "columns": {
          "type": "array",
          "items": {
            "type": "object",
            "$ref": "#/definitions/mbpbColumn"
          },
          "title": "字段类"
        },
        "nextRunTime": {
          "type": "string",
          "title": "下次运行时间 可选 手动运行需要"
        },
        "error": {
          "$ref": "#/definitions/mbpbError",
          "title": "错误信息 可选"
        }
      },
      "title": "运行响应"
    },
    "mbpbRequest": {
      "type": "object",
      "properties": {
        "enterpriseID": {
          "type": "string",
          "title": "企业ID"
        },
        "cardId": {
          "type": "string",
          "format": "int64",
          "title": "int64 CardId = 2 [(validate.rules).int64.gte = 1]; // Card ID"
        },
        "over": {
          "$ref": "#/definitions/mbpbOver",
          "title": "BI不传"
        }
      },
      "title": "行动请求"
    },
    "mbpbRunStatus": {
      "type": "string",
      "enum": [
        "Unknown",
        "NotRunning",
        "Scheme",
        "Running",
        "Success",
        "Fail",
        "Cancel",
        "Skip"
      ],
      "default": "Unknown",
      "description": "- Unknown: 未知\n - NotRunning: 未运行\n - Scheme: 计划中\n - Running: 运行中\n - Success: 运行成功\n - Fail: 运行失败\n - Cancel: 已取消\n - Skip: 跳过",
      "title": "运行状态"
    },
    "mbpbRunType": {
      "type": "string",
      "enum": [
        "Cycle",
        "Spark"
      ],
      "default": "Cycle",
      "title": "- Cycle: 周期\n - Spark: 手动"
    },
    "mbpbSource": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "title": "baseId+type hash BI不传"
        },
        "baseId": {
          "type": "string",
          "title": "原始唯一键"
        },
        "type": {
          "$ref": "#/definitions/mbpbSourceType",
          "title": "类型"
        },
        "prev": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#/definitions/mbpbProperty"
          },
          "title": "上级 BI不传"
        },
        "runStatus": {
          "$ref": "#/definitions/mbpbRunStatus",
          "title": "运行状态 BI不传"
        }
      },
      "title": "来源"
    },
    "mbpbSourceType": {
      "type": "string",
      "enum": [
        "RemoteDB",
        "ImportData",
        "DataFill",
        "MbEtl",
        "RemoteApi",
        "UnknownSrc"
      ],
      "default": "RemoteDB",
      "title": "- RemoteDB: 远程数据库\n - ImportData: 导入数据\n - DataFill: 数据填报\n - MbEtl: ETL\n - RemoteApi: RemoteAPI\n - UnknownSrc: 未知"
    },
    "mbpbTable": {
      "type": "object",
      "properties": {
        "schema": {
          "type": "string",
          "title": "schema"
        },
        "table": {
          "type": "string",
          "title": "table"
        },
        "source": {
          "$ref": "#/definitions/mbpbSource",
          "title": "来源"
        },
        "target": {
          "$ref": "#/definitions/mbpbSource",
          "title": "目标 BI不传"
        }
      },
      "title": "实体表"
    },
    "mbpbTaskType": {
      "type": "string",
      "enum": [
        "BasicTask",
        "FlowTask",
        "WebhookTask"
      ],
      "default": "BasicTask",
      "description": "- BasicTask: 基本任务\n - FlowTask: 工作流\n - WebhookTask: 钩子任务",
      "title": "任务类型"
    },
    "mbpbWithMonth": {
      "type": "object",
      "properties": {
        "month": {
          "$ref": "#/definitions/mbpbEnumMonth",
          "title": "月份"
        },
        "day": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "int32"
          },
          "title": "天 切片 -1=最后1天"
        }
      },
      "title": "月份"
    },
    "mbpbWithQuarter": {
      "type": "object",
      "properties": {
        "month": {
          "type": "integer",
          "format": "int32",
          "title": "第N个月"
        },
        "day": {
          "type": "array",
          "items": {
            "type": "integer",
            "format": "int32"
          },
          "title": "天 切片 -1=最后1天"
        }
      },
      "title": "季"
    },
    "mbpbWorkflowReply": {
      "type": "object",
      "properties": {
        "enableReply": {
          "$ref": "#/definitions/mbpbEnableReply"
        },
        "flowReply": {
          "$ref": "#/definitions/mbpbReply"
        }
      }
    },
    "protobufAny": {
      "type": "object",
      "properties": {
        "@type": {
          "type": "string"
        }
      },
      "additionalProperties": {}
    }
  }
}
